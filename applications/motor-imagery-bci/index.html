<!DOCTYPE html>
<html><head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="canonical" href="https://wiki.mentalab.com/applications/motor-imagery-bci/">

    <title>
        
        Motor Imagery BCI | Wiki
        
    </title>

    
    <link href="https://wiki.mentalab.com/css/fontawesome.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

    
    <link rel="stylesheet" href="https://wiki.mentalab.com/css/ace.min.css">

    

</head>
<body><nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow sticky-top" id="navbarMain">
    <div class="container">
        <div>
            <a class="navbar-brand" href="/">
                <img style="padding:10px 10px 15px 10px;" src="https://mentalab.com/wp-content/uploads/2024/05/mentalab-logo.svg" />
                Wiki
            </a>
        </div>
        
    </div>
    <a class="nav-link" href="https://mentalab.com">
		<button class="btn btn-secondary mt-n1" style="margin: 0px 100px 0px 0px; ">mentalab.com</button>
	</a>
</nav>
<div class="container-fluid">
            <div class="row">

                <div class="docs-sidenav order-0 col-12 col-md-3 col-lg-2 col-xl-2 position-sticky border-right"><nav class="navbar navbar-expand-md navbar-light pl-0">
    <button class="navbar-toggler navbar-toggler-right collapsed" type="button" data-toggle="collapse" data-target="#sidenav-left-collapse" aria-controls="sidenav-left-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

     <div class="collapse navbar-collapse align-items-start flex-column" id="sidenav-left-collapse">
         <ul class="navbar-nav flex-column pt-3">
    <li data-nav-id="/quick-links/" class="nav-item my-1
        ">
        
        <a class="nav-link p-0" href="/quick-links/"><h6>Quick Links</h6></a>
    </li>
    <li data-nav-id="/user-guide/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/user-guide/"><h6>User Guide</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/user-guide/operating-instructions/" class="nav-item my-1">
                
                 <a href="/user-guide/operating-instructions/" class="nav-link p-0">
                    Operating Instructions
                </a>
        </li>
        <li data-nav-id="/user-guide/dry-electrode-guide/" class="nav-item my-1">
                
                 <a href="/user-guide/dry-electrode-guide/" class="nav-link p-0">
                    Dry Electrode Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/led-light-guide/" class="nav-item my-1">
                
                 <a href="/user-guide/led-light-guide/" class="nav-link p-0">
                    LED Light Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/button-guide/" class="nav-item my-1">
                
                 <a href="/user-guide/button-guide/" class="nav-link p-0">
                    Button Command Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/cap-size-guide/" class="nav-item my-1">
                
                 <a href="/user-guide/cap-size-guide/" class="nav-link p-0">
                    Cap Size Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/improving-impedances/" class="nav-item my-1">
                
                 <a href="/user-guide/improving-impedances/" class="nav-link p-0">
                    Improving Impedances
                </a>
        </li>
        <li data-nav-id="/user-guide/explorepy-commands/" class="nav-item my-1">
                
                 <a href="/user-guide/explorepy-commands/" class="nav-link p-0">
                    explorepy Command Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/cleaning-disinfection-storage/" class="nav-item my-1">
                
                 <a href="/user-guide/cleaning-disinfection-storage/" class="nav-link p-0">
                    Cleaning, Disinfecting and Storing Mentalab Hardware
                </a>
        </li>
        <li data-nav-id="/user-guide/safety-recommendations/" class="nav-item my-1">
                
                 <a href="/user-guide/safety-recommendations/" class="nav-link p-0">
                    Safety Recommendations
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/event-triggers/" class="nav-item my-1
        ">
        
        <a class="nav-link p-0" href="/event-triggers/"><h6>Event Triggers</h6></a>
    </li>
    <li data-nav-id="/applications/" class="nav-item my-1 parent haschildren
        ">
        
        <a class="nav-link p-0" href="/applications/"><h6>Applications</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/applications/motor-imagery-bci/" class="nav-item my-1 active">
                
                 <a href="/applications/motor-imagery-bci/" class="nav-link p-0">
                    Motor Imagery BCI
                </a>
        </li>
        <li data-nav-id="/applications/artefact-removal/" class="nav-item my-1">
                
                 <a href="/applications/artefact-removal/" class="nav-link p-0">
                    Artefact removal
                </a>
        </li>
        <li data-nav-id="/applications/power-bands/" class="nav-item my-1">
                
                 <a href="/applications/power-bands/" class="nav-link p-0">
                    EOG Artifact Removal
                </a>
        </li>
        <li data-nav-id="/applications/ssvep/" class="nav-item my-1">
                
                 <a href="/applications/ssvep/" class="nav-link p-0">
                    SSVEP Experiments
                </a>
        </li>
        <li data-nav-id="/applications/easi-ecg/" class="nav-item my-1">
                
                 <a href="/applications/easi-ecg/" class="nav-link p-0">
                    EASI ECG
                </a>
        </li>
        <li data-nav-id="/applications/ecg-analysis/" class="nav-item my-1">
                
                 <a href="/applications/ecg-analysis/" class="nav-link p-0">
                    ECG Analysis
                </a>
        </li>
        <li data-nav-id="/applications/p300/" class="nav-item my-1">
                
                 <a href="/applications/p300/" class="nav-link p-0">
                    P300 Experiment
                </a>
        </li>
        <li data-nav-id="/applications/sleep-recording-protocol/" class="nav-item my-1">
                
                 <a href="/applications/sleep-recording-protocol/" class="nav-link p-0">
                    Sleep Recording Protocol
                </a>
        </li>
        <li data-nav-id="/applications/sleep-analysis/" class="nav-item my-1">
                
                 <a href="/applications/sleep-analysis/" class="nav-link p-0">
                    Sleep EEG Analysis
                </a>
        </li>
        <li data-nav-id="/applications/spectrogram/" class="nav-item my-1">
                
                 <a href="/applications/spectrogram/" class="nav-link p-0">
                    Real-time Spectrogram
                </a>
        </li>
        <li data-nav-id="/applications/eegsynth/" class="nav-item my-1">
                
                 <a href="/applications/eegsynth/" class="nav-link p-0">
                    EEGSynth
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/integrations/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/integrations/"><h6>Integrations</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/integrations/supported-software/" class="nav-item my-1">
                
                 <a href="/integrations/supported-software/" class="nav-link p-0">
                    Supported Software
                </a>
        </li>
        <li data-nav-id="/integrations/eeglab/" class="nav-item my-1">
                
                 <a href="/integrations/eeglab/" class="nav-link p-0">
                    EEGLAB
                </a>
        </li>
        <li data-nav-id="/integrations/mne-python/" class="nav-item my-1">
                
                 <a href="/integrations/mne-python/" class="nav-link p-0">
                    MNE Python
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/faqs/" class="nav-item my-1
        ">
        
        <a class="nav-link p-0" href="/faqs/"><h6>FAQs</h6></a>
    </li>
    <li data-nav-id="/explore-desktop-guide/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/explore-desktop-guide/"><h6>Explore Desktop Guide</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/explore-desktop-guide/getting-started/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/getting-started/" class="nav-link p-0">
                    Getting Started
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/usage/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/usage/" class="nav-link p-0">
                    Usage
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/visualize/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/visualize/" class="nav-link p-0">
                    Visualization
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/record/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/record/" class="nav-link p-0">
                    Recording
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/impedance/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/impedance/" class="nav-link p-0">
                    Impedance
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/lsl/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/lsl/" class="nav-link p-0">
                    Lab Streaming Layer
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/other/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/other/" class="nav-link p-0">
                    Other
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/troubleshooting/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/troubleshooting/" class="nav-link p-0">
                    Troubleshooting
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/explore-mobile-guide/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/explore-mobile-guide/"><h6>Explore Mobile App</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/explore-mobile-guide/download-installation/" class="nav-item my-1">
                
                 <a href="/explore-mobile-guide/download-installation/" class="nav-link p-0">
                    Download and Installation
                </a>
        </li>
        <li data-nav-id="/explore-mobile-guide/usage/" class="nav-item my-1">
                
                 <a href="/explore-mobile-guide/usage/" class="nav-link p-0">
                    Usage
                </a>
        </li>
        <li data-nav-id="/explore-mobile-guide/testing/" class="nav-item my-1">
                
                 <a href="/explore-mobile-guide/testing/" class="nav-link p-0">
                    Tests
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/explore-signals-guide/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/explore-signals-guide/"><h6>Explore Signals Guide</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/explore-signals-guide/explore-signals-installation/" class="nav-item my-1">
                
                 <a href="/explore-signals-guide/explore-signals-installation/" class="nav-link p-0">
                    Installation
                </a>
        </li>
        <li data-nav-id="/explore-signals-guide/explore-signals-usage/" class="nav-item my-1">
                
                 <a href="/explore-signals-guide/explore-signals-usage/" class="nav-link p-0">
                    Usage
                </a>
        </li>
        </ul>
    </li>
        </ul>
    </div>
</nav>


</div>
                <div class="docs-toc large order-lg-2 order-md-0 order-xs-1 col-12 col-lg-2 col-xl-2 position-sticky border-left"><div class="docs-toc">
	<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#features">Features</a></li>
        <li><a href="#requirements">Requirements</a></li>
        <li><a href="#usage">Usage</a></li>
        <li><a href="#file-structure">File Structure</a></li>
        <li><a href="#classifiers">Classifiers</a></li>
        <li><a href="#customizing-the-transformer-model">Customizing the Transformer Model</a></li>
        <li><a href="#data-preprocessing">Data Preprocessing</a></li>
        <li><a href="#real-time-operation">Real-Time Operation</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
      </ul>
    </li>
    <li><a href="#future-improvements">Future Improvements</a></li>
  </ul>
</nav>
</div>
</div>
                <div class="main col-12 order-1 col-md-9 col-lg-10 col-xl-8 py-3">
                

<h1>Motor Imagery BCI</h1>

<h3 id="overview">Overview</h3>
<p>This application is a Brain-Computer Interface (BCI) system designed to classify motor imagery tasks (left hand, right hand, and neutral state) using EEG data. The system connects to Explore Pro device via the Lab Streaming Layer (LSL) protocol, processes the EEG signals, and classifies the data using machine learning models, including a Transformer-based neural network.</p>
<p>The application supports real-time classification. It includes tools for data collection, preprocessing, model training, and evaluation. The code for the application can be found in our <a href="https://github.com/Mentalab-hub/explorepy/tree/master/examples">explorepy/examples section on github</a>.</p>
<h3 id="features">Features</h3>
<ul>
<li><strong>Real-Time EEG Data Acquisition:</strong> Connects to an EEG device via LSL for real-time data streaming.</li>
<li><strong>Motor Imagery Classification:</strong> Classifies EEG data into three states: left hand movement, right hand movement, and neutral state.</li>
<li><strong>Transformer Model:</strong> Implements a Transformer-based neural network for EEG signal classification.</li>
<li><strong>Multiple Classifiers:</strong> Supports Linear Discriminant Analysis (LDA), Support Vector Machines (SVM), Random Forest (RF), and the custom Transformer model.</li>
<li><strong>Data Preprocessing:</strong> Includes bandpass filtering (mu and beta bands) and feature extraction (band power).</li>
<li><strong>Model Training and Evaluation:</strong> Allows training and evaluation of multiple classifiers with visualization of results.</li>
<li><strong>Real-Time BCI Operation:</strong> Runs in continuous mode for real-time classification and control.</li>
</ul>
<h3 id="requirements">Requirements</h3>
<h4 id="hardware">Hardware</h4>
<ul>
<li>An Explore Pro device.</li>
<li>A computer with sufficient processing power (GPU recommended for Transformer model training).</li>
</ul>
<h4 id="software">Software</h4>
<ul>
<li>
<p>Python 3.10 or higher</p>
</li>
<li>
<p>Required Python packages (install via pip):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install pylsl numpy scipy scikit-learn torch matplotlib seaborn pandas
</span></span></code></pre></div></li>
</ul>
<p>Ensure your EEG device is set up and streaming data via LSL.</p>
<h3 id="usage">Usage</h3>
<h4 id="1-collect-calibration-data">1. Collect Calibration Data</h4>
<p>To train the classifiers, you need to collect calibration data. Run the following command and follow the on-screen instructions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python main.py
</span></span></code></pre></div><p>Choose option <strong>1</strong> to train and compare all classifiers. The system will prompt you to perform left hand, right hand, and neutral state tasks.</p>
<h4 id="2-train-classifiers">2. Train Classifiers</h4>
<p>The application will automatically preprocess the data, extract features, and train multiple classifiers (LDA, SVM, Random Forest, and Transformer). Training progress and results will be displayed in the console.</p>
<h4 id="3-run-real-time-bci">3. Run Real-Time BCI</h4>
<p>After training, you can run the BCI in real-time mode:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python main.py
</span></span></code></pre></div><p>Choose option <strong>2</strong> to run the BCI with the best-performing classifier or option <strong>3</strong> to select a specific classifier.</p>
<h3 id="file-structure">File Structure</h3>
<pre tabindex="0"><code>motor-imagery-bci/
├── models/                  # Saved classifier models
├── dataset/                 # Saved calibration datasets
├── main.py                  # Main application script
├── README.md                # This file
</code></pre><h3 id="classifiers">Classifiers</h3>
<p>The application supports the following classifiers:</p>
<ul>
<li><strong>Linear Discriminant Analysis (LDA)</strong></li>
<li><strong>Support Vector Machine (SVM)</strong></li>
<li><strong>Random Forest (RF)</strong></li>
<li><strong>Transformer Model</strong></li>
</ul>
<h3 id="customizing-the-transformer-model">Customizing the Transformer Model</h3>
<p>The Transformer model is defined in the <code>EEGTransformer</code> class. You can customize the following parameters:</p>
<ul>
<li><code>input_dim</code>: Input feature dimension.</li>
<li><code>num_classes</code>: Number of output classes (default: 3).</li>
<li><code>d_model</code>: Dimension of the model (default: 64).</li>
<li><code>nhead</code>: Number of attention heads (default: 8).</li>
<li><code>num_layers</code>: Number of Transformer encoder layers (default: 4).</li>
<li><code>dropout</code>: Dropout rate (default: 0.2).</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>model <span style="color:#f92672">=</span> EEGTransformer(input_dim<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>, num_classes<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, d_model<span style="color:#f92672">=</span><span style="color:#ae81ff">128</span>, nhead<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>, num_layers<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>, dropout<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)
</span></span></code></pre></div><h3 id="data-preprocessing">Data Preprocessing</h3>
<p>The EEG data is preprocessed as follows:</p>
<ul>
<li><strong>Bandpass Filtering:</strong> Applied to extract mu (8-12 Hz) and beta (16-24 Hz) bands.</li>
<li><strong>Feature Extraction:</strong> Band power is calculated for each frequency band.</li>
<li><strong>Dataset Preparation:</strong> Features and labels are saved in a CSV file for training.</li>
</ul>
<h3 id="real-time-operation">Real-Time Operation</h3>
<p>In real-time mode, the application:</p>
<ol>
<li>Continuously collects EEG data from the LSL stream.</li>
<li>Applies preprocessing and feature extraction.</li>
<li>Classifies the data using the selected model.</li>
<li>Displays the detected state (left hand, right hand, or neutral) and certainty level.</li>
</ol>
<h3 id="troubleshooting">Troubleshooting</h3>
<h4 id="1-lsl-stream-not-found">1. LSL Stream Not Found</h4>
<ul>
<li>Ensure your device is properly connected and streaming data.</li>
<li>Verify the stream name in the <code>MotorImageryBCI</code> class initialization.</li>
</ul>
<h4 id="2-poor-classification-accuracy">2. Poor Classification Accuracy</h4>
<ul>
<li>Collect more calibration data.</li>
<li>Adjust the frequency bands (<code>mu_band</code> and <code>beta_band</code>) in the <code>MotorImageryBCI</code> class.</li>
<li>Fine-tune the Transformer model parameters.</li>
</ul>
<h4 id="3-performance-issues">3. Performance Issues</h4>
<ul>
<li>Use a GPU for training the Transformer model.</li>
<li>Reduce the window size or overlap in the <code>MotorImageryBCI</code> class.</li>
</ul>
<hr>
<h2 id="future-improvements">Future Improvements</h2>
<p>While the current system is functional, several enhancements can improve its accuracy, real-time performance, and adaptability:</p>
<ol>
<li>
<p><strong>Advanced Deep Learning Models</strong></p>
<ul>
<li>Replace traditional classifiers (LDA, SVM, RF) with more powerful architectures like <strong>EEGNet, ConvLSTM, or Graph Neural Networks (GNNs)</strong>.</li>
<li>Optimize the Transformer model by using <strong>EEG-specialized architectures</strong> such as <strong>TS-Transformer</strong> or <strong>EEGFormer</strong> for better time-series representation.</li>
</ul>
</li>
<li>
<p><strong>Enhanced Feature Extraction</strong></p>
<ul>
<li>Incorporate <strong>Common Spatial Patterns (CSP)</strong> to improve the separation of motor imagery classes.</li>
<li>Use <strong>Riemannian geometry-based approaches</strong> to extract more robust spatial features.</li>
</ul>
</li>
<li>
<p><strong>Data Augmentation for EEG</strong></p>
<ul>
<li>Implement <strong>synthetic EEG data generation</strong> techniques like <strong>time-domain warping, frequency shifting, and GAN-based augmentation</strong> to improve model generalization.</li>
</ul>
</li>
<li>
<p><strong>Online &amp; Transfer Learning</strong></p>
<ul>
<li>Introduce <strong>adaptive learning</strong> to fine-tune the model based on user-specific EEG patterns.</li>
<li>Use <strong>few-shot learning</strong> or <strong>domain adaptation techniques</strong> to improve performance across multiple users.</li>
</ul>
</li>
</ol>


    


                </div>

            </div> 

        </div> 
<p style="text-align: center;">Copyright © 2025 Mentalab</p>
<script src="https://wiki.mentalab.com/lib/jquery.min.js"></script> 
<script src="https://wiki.mentalab.com/lib/popper.min.js"></script> 

<script src="https://wiki.mentalab.com/js/bootstrap.min.js"></script> 


<script type="text/javascript" src="/plugins/lunr.min.js"></script>
<script type="text/javascript" src="/plugins/auto-complete.js"></script>
<link href="/plugins/auto-complete.css" rel="stylesheet">

<script type="text/javascript">
    var baseurl = "https:\/\/wiki.mentalab.com\/";
</script>
<script type="text/javascript" src="/plugins/search.js"></script>


<script type="text/javascript" src="/plugins/clipboard.js"></script>
<script>
  new ClipboardJS('.btn');
</script>
</body>
</html>
