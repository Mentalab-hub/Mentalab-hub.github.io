<!DOCTYPE html>
<html><head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="canonical" href="https://wiki.mentalab.com/applications/photodiode-event-trigger/">

    <title>
        
        Photodiode Event Triggers | Wiki
        
    </title>

    
    <link href="https://wiki.mentalab.com/css/fontawesome.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

    
    <link rel="stylesheet" href="https://wiki.mentalab.com/css/ace.min.css">

    

</head>
<body><nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow sticky-top" id="navbarMain">
    <div class="container">
        <div>
            <a class="navbar-brand" href="/">
                <img style="padding:10px 10px 15px 10px;" src="https://mentalab.com/wp-content/uploads/2024/05/mentalab-logo.svg" />
                Wiki
            </a>
        </div>
        
    </div>
    <a class="nav-link" href="https://mentalab.com">
		<button class="btn btn-secondary mt-n1" style="margin: 0px 100px 0px 0px; ">mentalab.com</button>
	</a>
</nav>
<div class="container-fluid">
            <div class="row">

                <div class="docs-sidenav order-0 col-12 col-md-3 col-lg-2 col-xl-2 position-sticky border-right"><nav class="navbar navbar-expand-md navbar-light pl-0">
    <button class="navbar-toggler navbar-toggler-right collapsed" type="button" data-toggle="collapse" data-target="#sidenav-left-collapse" aria-controls="sidenav-left-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

     <div class="collapse navbar-collapse align-items-start flex-column" id="sidenav-left-collapse">
         <ul class="navbar-nav flex-column pt-3">
    <li data-nav-id="/quick-links/" class="nav-item my-1
        ">
        
        <a class="nav-link p-0" href="/quick-links/"><h6>Quick Links</h6></a>
    </li>
    <li data-nav-id="/user-guide/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/user-guide/"><h6>User Guide</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/user-guide/operating-instructions/" class="nav-item my-1">
                
                 <a href="/user-guide/operating-instructions/" class="nav-link p-0">
                    Operating Instructions
                </a>
        </li>
        <li data-nav-id="/user-guide/dry-electrode-guide/" class="nav-item my-1">
                
                 <a href="/user-guide/dry-electrode-guide/" class="nav-link p-0">
                    Dry Electrode Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/led-light-guide/" class="nav-item my-1">
                
                 <a href="/user-guide/led-light-guide/" class="nav-link p-0">
                    LED Light Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/button-guide/" class="nav-item my-1">
                
                 <a href="/user-guide/button-guide/" class="nav-link p-0">
                    Button Command Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/cap-size-guide/" class="nav-item my-1">
                
                 <a href="/user-guide/cap-size-guide/" class="nav-link p-0">
                    Cap Size Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/improving-impedances/" class="nav-item my-1">
                
                 <a href="/user-guide/improving-impedances/" class="nav-link p-0">
                    Improving Impedances
                </a>
        </li>
        <li data-nav-id="/user-guide/explorepy-commands/" class="nav-item my-1">
                
                 <a href="/user-guide/explorepy-commands/" class="nav-link p-0">
                    explorepy Command Guide
                </a>
        </li>
        <li data-nav-id="/user-guide/cleaning-disinfection-storage/" class="nav-item my-1">
                
                 <a href="/user-guide/cleaning-disinfection-storage/" class="nav-link p-0">
                    Cleaning, Disinfecting and Storing Mentalab Hardware
                </a>
        </li>
        <li data-nav-id="/user-guide/safety-recommendations/" class="nav-item my-1">
                
                 <a href="/user-guide/safety-recommendations/" class="nav-link p-0">
                    Safety Recommendations
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/event-triggers/" class="nav-item my-1
        ">
        
        <a class="nav-link p-0" href="/event-triggers/"><h6>Event Triggers</h6></a>
    </li>
    <li data-nav-id="/applications/" class="nav-item my-1 parent haschildren
        ">
        
        <a class="nav-link p-0" href="/applications/"><h6>Applications</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/applications/motor-imagery-bci/" class="nav-item my-1">
                
                 <a href="/applications/motor-imagery-bci/" class="nav-link p-0">
                    Motor Imagery BCI
                </a>
        </li>
        <li data-nav-id="/applications/artefact-removal/" class="nav-item my-1">
                
                 <a href="/applications/artefact-removal/" class="nav-link p-0">
                    Artefact removal
                </a>
        </li>
        <li data-nav-id="/applications/sleep-actigraphy/" class="nav-item my-1">
                
                 <a href="/applications/sleep-actigraphy/" class="nav-link p-0">
                    Sleep Actigraphy
                </a>
        </li>
        <li data-nav-id="/applications/power-bands/" class="nav-item my-1">
                
                 <a href="/applications/power-bands/" class="nav-link p-0">
                    EOG Artifact Removal
                </a>
        </li>
        <li data-nav-id="/applications/ssvep/" class="nav-item my-1">
                
                 <a href="/applications/ssvep/" class="nav-link p-0">
                    SSVEP Experiments
                </a>
        </li>
        <li data-nav-id="/applications/easi-ecg/" class="nav-item my-1">
                
                 <a href="/applications/easi-ecg/" class="nav-link p-0">
                    EASI ECG
                </a>
        </li>
        <li data-nav-id="/applications/p300/" class="nav-item my-1">
                
                 <a href="/applications/p300/" class="nav-link p-0">
                    P300 Experiment
                </a>
        </li>
        <li data-nav-id="/applications/sleep-recording-protocol/" class="nav-item my-1">
                
                 <a href="/applications/sleep-recording-protocol/" class="nav-link p-0">
                    Sleep Recording Protocol
                </a>
        </li>
        <li data-nav-id="/applications/sleep-analysis/" class="nav-item my-1">
                
                 <a href="/applications/sleep-analysis/" class="nav-link p-0">
                    Sleep EEG Analysis
                </a>
        </li>
        <li data-nav-id="/applications/ecg-analysis/" class="nav-item my-1">
                
                 <a href="/applications/ecg-analysis/" class="nav-link p-0">
                    ECG Analysis
                </a>
        </li>
        <li data-nav-id="/applications/eegsynth/" class="nav-item my-1">
                
                 <a href="/applications/eegsynth/" class="nav-link p-0">
                    EEGSynth
                </a>
        </li>
        <li data-nav-id="/applications/spectrogram/" class="nav-item my-1">
                
                 <a href="/applications/spectrogram/" class="nav-link p-0">
                    Real-time Spectrogram
                </a>
        </li>
        <li data-nav-id="/applications/eeg-to-lamp/" class="nav-item my-1">
                
                 <a href="/applications/eeg-to-lamp/" class="nav-link p-0">
                    EEG to lamp brightness
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/integrations/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/integrations/"><h6>Integrations</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/integrations/supported-software/" class="nav-item my-1">
                
                 <a href="/integrations/supported-software/" class="nav-link p-0">
                    Supported Software
                </a>
        </li>
    <li data-nav-id="/integrations/stimulation/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/integrations/stimulation/"><h6>Stimulation</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/integrations/stimulation/psychopy/" class="nav-item my-1">
                
                 <a href="/integrations/stimulation/psychopy/" class="nav-link p-0">
                    PsychoPy
                </a>
        </li>
        <li data-nav-id="/integrations/stimulation/2-opensesame/" class="nav-item my-1">
                
                 <a href="/integrations/stimulation/2-opensesame/" class="nav-link p-0">
                    
                </a>
        </li>
        <li data-nav-id="/integrations/stimulation/3-e-prime/" class="nav-item my-1">
                
                 <a href="/integrations/stimulation/3-e-prime/" class="nav-link p-0">
                    
                </a>
        </li>
        <li data-nav-id="/integrations/stimulation/4-presentation/" class="nav-item my-1">
                
                 <a href="/integrations/stimulation/4-presentation/" class="nav-link p-0">
                    
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/integrations/analysis/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/integrations/analysis/"><h6>Analysis</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/integrations/analysis/eeglab/" class="nav-item my-1">
                
                 <a href="/integrations/analysis/eeglab/" class="nav-link p-0">
                    EEGLAB
                </a>
        </li>
        <li data-nav-id="/integrations/analysis/mne-python/" class="nav-item my-1">
                
                 <a href="/integrations/analysis/mne-python/" class="nav-link p-0">
                    MNE Python
                </a>
        </li>
        <li data-nav-id="/integrations/analysis/fieldtrip/" class="nav-item my-1">
                
                 <a href="/integrations/analysis/fieldtrip/" class="nav-link p-0">
                    FieldTrip
                </a>
        </li>
        <li data-nav-id="/integrations/analysis/neuropype/" class="nav-item my-1">
                
                 <a href="/integrations/analysis/neuropype/" class="nav-link p-0">
                    NeuroPype
                </a>
        </li>
        <li data-nav-id="/integrations/analysis/besa-research/" class="nav-item my-1">
                
                 <a href="/integrations/analysis/besa-research/" class="nav-link p-0">
                    BESA Research
                </a>
        </li>
        <li data-nav-id="/integrations/analysis/6-brainstorm/" class="nav-item my-1">
                
                 <a href="/integrations/analysis/6-brainstorm/" class="nav-link p-0">
                    
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/integrations/interfaces/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/integrations/interfaces/"><h6>Interfaces</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/integrations/interfaces/brainflow/" class="nav-item my-1">
                
                 <a href="/integrations/interfaces/brainflow/" class="nav-link p-0">
                    BrainFlow
                </a>
        </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/faqs/" class="nav-item my-1
        ">
        
        <a class="nav-link p-0" href="/faqs/"><h6>FAQs</h6></a>
    </li>
    <li data-nav-id="/explore-desktop-guide/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/explore-desktop-guide/"><h6>Explore Desktop Guide</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/explore-desktop-guide/getting-started/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/getting-started/" class="nav-link p-0">
                    Getting Started
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/usage/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/usage/" class="nav-link p-0">
                    Usage
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/visualize/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/visualize/" class="nav-link p-0">
                    Visualization
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/record/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/record/" class="nav-link p-0">
                    Recording
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/impedance/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/impedance/" class="nav-link p-0">
                    Impedance
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/lsl/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/lsl/" class="nav-link p-0">
                    Lab Streaming Layer
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/other/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/other/" class="nav-link p-0">
                    Other
                </a>
        </li>
        <li data-nav-id="/explore-desktop-guide/troubleshooting/" class="nav-item my-1">
                
                 <a href="/explore-desktop-guide/troubleshooting/" class="nav-link p-0">
                    Troubleshooting
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/explore-mobile-guide/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/explore-mobile-guide/"><h6>Explore Mobile App</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/explore-mobile-guide/download-installation/" class="nav-item my-1">
                
                 <a href="/explore-mobile-guide/download-installation/" class="nav-link p-0">
                    Download and Installation
                </a>
        </li>
        <li data-nav-id="/explore-mobile-guide/usage/" class="nav-item my-1">
                
                 <a href="/explore-mobile-guide/usage/" class="nav-link p-0">
                    Usage
                </a>
        </li>
        <li data-nav-id="/explore-mobile-guide/testing/" class="nav-item my-1">
                
                 <a href="/explore-mobile-guide/testing/" class="nav-link p-0">
                    Tests
                </a>
        </li>
        </ul>
    </li>
    <li data-nav-id="/explore-signals-guide/" class="nav-item my-1 haschildren
        ">
        
        <a class="nav-link p-0" href="/explore-signals-guide/"><h6>Explore Signals Guide</h6></a>
        <ul class="list-unstyled ml-2">
        <li data-nav-id="/explore-signals-guide/explore-signals-installation/" class="nav-item my-1">
                
                 <a href="/explore-signals-guide/explore-signals-installation/" class="nav-link p-0">
                    Installation
                </a>
        </li>
        <li data-nav-id="/explore-signals-guide/explore-signals-usage/" class="nav-item my-1">
                
                 <a href="/explore-signals-guide/explore-signals-usage/" class="nav-link p-0">
                    Usage
                </a>
        </li>
        </ul>
    </li>
        </ul>
    </div>
</nav>


</div>
                <div class="docs-toc large order-lg-2 order-md-0 order-xs-1 col-12 col-lg-2 col-xl-2 position-sticky border-left"><div class="docs-toc">
	<nav id="TableOfContents">
  <ul>
    <li><a href="#set-up">Set-up</a></li>
    <li><a href="#create-stimuli">Create stimuli</a></li>
    <li><a href="#delay-and-jitter-measurements">Delay and jitter measurements</a></li>
    <li><a href="#experiment">Experiment</a></li>
  </ul>
</nav>
</div>
</div>
                <div class="main col-12 order-1 col-md-9 col-lg-10 col-xl-8 py-3">
                

<h1>Photodiode Event Triggers</h1>

<p>Synchronizing ExG signals with stimuli is critical to many research paradigms. There are two main approaches to synchronizing data: software event markers and hardware triggers.</p>
<p>Although software event markers are easy to use, they are not as precise as hardware triggers. This is because the data is sent via Bluetooth, which has some inherent delays.</p>
<p>Meanwhile, hardware triggers are much more precise but involve connecting a wire between devices (e.g. a computer and an Explore device). This means your Mentalab Explore system is no longer fully wireless (although presenting stimuli on a mobile can mitigate this).</p>
<p>The current version of the Explore system does not have a trigger input pin. Therefore, one of ExG channels has to be used for trigger input. In some experiments where visual stimuli are presented on a screen, a photosensor can be used to transmit triggers and synchronize the ExG signal with visual stimuli very precisely. In this tutorial, we demonstrate how we can setup such a system.</p>
<h2 id="set-up">Set-up</h2>
<figure style="float:right;">
<img class="mobile" src="\img\Applications\photodiode.png" alt="OPT101 photosensor" width="400"/>
<figcaption> OPT101 photosensor.</figcaption>
</figure>
<p>Obtain a <a href="https://www.amazon.de/-/en/Ba30DEllylelly-OPT101-analogue-intensity-monolithic/dp/B08FYJV12J/ref=sr_1_11?dchild=1&amp;keywords=Fotodiode&amp;qid=1634715575&amp;sr=8-11">OPT101 photosensor</a>, or any other photosensor that has a short rise/fall time.</p>
<p>Connect the photosensor using the following connection combinations.</p>
<table>
  <thead>
      <tr>
          <th>  In</th>
          <th>  Out</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>OPT101 pins</td>
          <td>Explore / power supply</td>
      </tr>
      <tr>
          <td>Vcc</td>
          <td>5V on power supply</td>
      </tr>
      <tr>
          <td>-V and COM</td>
          <td>Explore Ground and power supply Ground</td>
      </tr>
      <tr>
          <td>1M and OUT</td>
          <td>CH1 of Explore device</td>
      </tr>
  </tbody>
</table>
<h2 id="create-stimuli">Create stimuli</h2>
<p>The following is a simple code snippet in Python to show a black rectangle on the screen every second using <a href="https://www.psychopy.org/">PsychoPy</a>.</p>
<pre tabindex="0"><code>import time
from psychopy import visual

isi = .5

win = visual.Window(size=(600, 800), fullscr=True, screen=1, color=[1, 1, 1])
stim = visual.Rect(win, size=(.5, .5), fillColor=&#39;black&#39;, pos=(-.75, -.75))

time.sleep(1)
delays = []
for i in range(500):
    stim.draw()
    win.flip()
    time.sleep(isi)
    win.flip()
    time.sleep(isi)

time.sleep(5)
</code></pre><p>We can then use the on-screen color change created by the stimulus as an event trigger. The following video shows how the on-screen stimulus corresponds to changes in the channel 1 signal.</p>
<div class="video-container">
<iframe src="https://www.youtube-nocookie.com/embed/KPlwJewogJ4" title="Photodiode trigger" frameborder="0" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<br>

<div class="alert alert-info" role="alert">
    The visualization in the recorded video applies a notch filter which causes some distortion in the signal. When you are recording raw data, the square wave is cleaner.
</div>

<h2 id="delay-and-jitter-measurements">Delay and jitter measurements</h2>
<p>The following code snippet allows you to measure the delay and jitter of your event markers as they are recorded by your device.</p>
<pre tabindex="0"><code>import time
from psychopy import visual
from explorepy import Explore

isi = .5

explore = Explore()
explore.connect(&#39;Explore_CA12&#39;)
explore.record_data(file_name=&#39;rec_01&#39;, file_type=&#39;csv&#39;, do_overwrite=False)

win = visual.Window(size=(600, 800), fullscr=True, screen=1, color=[1, 1, 1])
stim = visual.Rect(win, size=(.5, .5), fillColor=&#39;black&#39;, pos=(-.75, -.75))

time.sleep(1)
delays = []
for i in range(500):
    stim.draw()
    win.flip()
    explore.set_marker(10)
    time.sleep(isi)
    win.flip()
    time.sleep(isi)

time.sleep(5)
explore.stop_recording()
</code></pre><h2 id="experiment">Experiment</h2>
<p>Finally, we can create an experiment and record CSV files to drive. The files can be imported in Python and the delay i.e. time distance between the rise of the signal of channel 1 and the event marker can be computed as follows.</p>
<pre tabindex="0"><code>import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import scipy.signal as signal

fs = 250  # Sampling rate
n_max = int(fs/3)
exg_filename = &#39;FILENAME_ExG.csv&#39;
marker_filename = &#39;FILENAME_Marker.csv&#39;

exg = pd.read_csv(exg_filename)
markers = pd.read_csv(marker_filename)

sig = exg[&#39;ch1&#39;].to_numpy()
ts_sig = exg[&#39;TimeStamp&#39;].to_numpy()
ts_marker = markers[&#39;TimeStamp&#39;].to_numpy()
sig_diff = -1*np.diff(sig)
peaks, _ = signal.find_peaks(sig_diff, threshold=1000)

epochs = np.zeros((500, n_max))
epochs_sig = np.zeros((500, n_max))
delays = []
for i, event_ts in enumerate(ts_marker):
    idx = np.argmax(ts_sig &gt; event_ts)
    ind_jump = np.argmax(sig_diff[idx:idx+n_max]&gt;1)
    if ts_sig[idx+ind_jump]-event_ts &lt; 0:
        print(&#39;error&#39;)
    delays.append(ts_sig[idx+ind_jump]-event_ts)
    print(i, ind_jump, ts_sig[idx+ind_jump]-event_ts)
    epochs[i, :] = sig_diff[idx:idx+n_max]
    epochs_sig[i, :] = sig[idx:idx+n_max]

print(np.array(delays).mean(), np.array(delays).std())

plt.plot(np.array(delays)*1000)
plt.title(f&#39;Delays: mean={np.array(delays).mean()*1000:.1f} ms, Std={np.array(delays).std()*1000:.1f} ms&#39;)
plt.xlabel(&#39;Trial&#39;)
plt.ylabel(&#39;Delay (ms)&#39;)
plt.show()
</code></pre><p>For more information or support, do not hesitate to get in contact at: <a href="mailto:support@mentalab.com">support@mentalab.com</a></p>


    


                </div>

            </div> 

        </div> 
<p style="text-align: center;">Copyright © 2025 Mentalab</p>
<script src="https://wiki.mentalab.com/lib/jquery.min.js"></script> 
<script src="https://wiki.mentalab.com/lib/popper.min.js"></script> 

<script src="https://wiki.mentalab.com/js/bootstrap.min.js"></script> 


<script type="text/javascript" src="/plugins/lunr.min.js"></script>
<script type="text/javascript" src="/plugins/auto-complete.js"></script>
<link href="/plugins/auto-complete.css" rel="stylesheet">

<script type="text/javascript">
    var baseurl = "https:\/\/wiki.mentalab.com\/";
</script>
<script type="text/javascript" src="/plugins/search.js"></script>


<script type="text/javascript" src="/plugins/clipboard.js"></script>
<script>
  new ClipboardJS('.btn');
</script>
</body>
</html>
